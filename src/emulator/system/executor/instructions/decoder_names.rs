use crate::emulator::system::components::registers::Register8;
use crate::emulator::system::executor::instructions::instruction::*;
use crate::emulator::system::executor::instructions::instruction::{
    BitOps::*, ControlOps::*, Instruction::*, Ld16::*,
};

pub fn decode_name(byte: u8) -> Result<String, String> {
    let high_nibble = byte & 0xF0;
    let low_nibble = byte & 0x0F;

    match high_nibble {
        0x00 => match low_nibble {
            0x0 => Ok("NOP".to_owned()),
            0x1 => Ok("LD BC, u16".to_owned()),
            0x2 => Ok("LD (BC), A".to_owned()),
            0x3 => Ok("INC BC".to_owned()),
            0x4 => Ok("INC B".to_owned()),
            0x5 => Ok("DEC B".to_owned()),
            0x6 => Ok("LD B, u8".to_owned()),
            0x7 => Ok("RLCA".to_owned()),
            0x8 => Ok("LD (u16), SP".to_owned()),
            0x9 => Ok("ADD HL, BC".to_owned()),
            0xA => Ok("LD A, (BC)".to_owned()),
            0xB => Ok("DEC BC".to_owned()),
            0xC => Ok("INC C".to_owned()),
            0xD => Ok("DEC C".to_owned()),
            0xE => Ok("LD C, u8".to_owned()),
            0xF => Ok("RRCA".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0x10 => match low_nibble {
            0x0 => Ok("STOP".to_owned()),
            0x1 => Ok("LD DE, u16".to_owned()),
            0x2 => Ok("LD (DE), A".to_owned()),
            0x3 => Ok("INC DE".to_owned()),
            0x4 => Ok("INC D".to_owned()),
            0x5 => Ok("DEC D".to_owned()),
            0x6 => Ok("LD D, u8".to_owned()),
            0x7 => Ok("RLA".to_owned()),
            0x8 => Ok("JR i8".to_owned()),
            0x9 => Ok("ADD HL, DE".to_owned()),
            0xA => Ok("LD A, (DE)".to_owned()),
            0xB => Ok("DEC DE".to_owned()),
            0xC => Ok("INC E".to_owned()),
            0xD => Ok("DEC E".to_owned()),
            0xE => Ok("LD E, u8".to_owned()),
            0xF => Ok("RRA".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0x20 => match low_nibble {
            0x0 => Ok("JR NZ, i8".to_owned()),
            0x1 => Ok("LD HL, u16".to_owned()),
            0x2 => Ok("LD (HL+), A".to_owned()),
            0x3 => Ok("INC HL".to_owned()),
            0x4 => Ok("INC H".to_owned()),
            0x5 => Ok("DEC H".to_owned()),
            0x6 => Ok("LD H, u8".to_owned()),
            0x7 => Ok("DAA".to_owned()),
            0x8 => Ok("JR Z, i8".to_owned()),
            0x9 => Ok("ADD HL, HL".to_owned()),
            0xA => Ok("LD A, (HL+)".to_owned()),
            0xB => Ok("DEC HL".to_owned()),
            0xC => Ok("INC L".to_owned()),
            0xD => Ok("DEC L".to_owned()),
            0xE => Ok("LD L, u8".to_owned()),
            0xF => Ok("CPL".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0x30 => match low_nibble {
            0x0 => Ok("JR NC, i8".to_owned()),
            0x1 => Ok("LD SP, u16".to_owned()),
            0x2 => Ok("LD (HL-), A".to_owned()),
            0x3 => Ok("INC SP".to_owned()),
            0x4 => Ok("INC (HL)".to_owned()),
            0x5 => Ok("DEC (HL)".to_owned()),
            0x6 => Ok("LD (HL), u8".to_owned()),
            0x7 => Ok("SCF".to_owned()),
            0x8 => Ok("JR C, i8".to_owned()),
            0x9 => Ok("add hl, sp".to_owned()),
            0xA => Ok("LD A, (HL-)".to_owned()),
            0xB => Ok("DEC SP".to_owned()),
            0xC => Ok("INC A".to_owned()),
            0xD => Ok("DEC A".to_owned()),
            0xE => Ok("LD A, u8".to_owned()),
            0xF => Ok("CCF".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0x40 => match low_nibble {
            0x0 => Ok("LD B, B".to_owned()),
            0x1 => Ok("LD B, C".to_owned()),
            0x2 => Ok("LD D, D".to_owned()),
            0x3 => Ok("LD B, E".to_owned()),
            0x4 => Ok("LD B, H".to_owned()),
            0x5 => Ok("LD B, L".to_owned()),
            0x6 => Ok("LD B, (HL)".to_owned()),
            0x7 => Ok("LD B, A".to_owned()),
            0x8 => Ok("LD C, B".to_owned()),
            0x9 => Ok("LD C, C".to_owned()),
            0xA => Ok("LD C, D".to_owned()),
            0xB => Ok("LD C, E".to_owned()),
            0xC => Ok("LD C, H".to_owned()),
            0xD => Ok("LD C, L".to_owned()),
            0xE => Ok("LD C, (HL)".to_owned()),
            0xF => Ok("LD C, A".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0x50 => match low_nibble {
            0x0 => Ok("LD D, B".to_owned()),
            0x1 => Ok("LD D, C".to_owned()),
            0x2 => Ok("LD D, D".to_owned()),
            0x3 => Ok("LD D, E".to_owned()),
            0x4 => Ok("LD D, H".to_owned()),
            0x5 => Ok("LD D, L".to_owned()),
            0x6 => Ok("LD D, (HL)".to_owned()),
            0x7 => Ok("LD D, A".to_owned()),
            0x8 => Ok("LD E, B".to_owned()),
            0x9 => Ok("LD E, C".to_owned()),
            0xA => Ok("LD E, D".to_owned()),
            0xB => Ok("LD E, E".to_owned()),
            0xC => Ok("LD E, H".to_owned()),
            0xD => Ok("LD E, L".to_owned()),
            0xE => Ok("LD E, (HL)".to_owned()),
            0xF => Ok("LD E, A".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0x60 => match low_nibble {
            0x0 => Ok("LD H, B".to_owned()),
            0x1 => Ok("LD H, C".to_owned()),
            0x2 => Ok("LD H, D".to_owned()),
            0x3 => Ok("LD H, E".to_owned()),
            0x4 => Ok("LD H, H".to_owned()),
            0x5 => Ok("LD H, L".to_owned()),
            0x6 => Ok("LD H, (HL)".to_owned()),
            0x7 => Ok("LD H, A".to_owned()),
            0x8 => Ok("LD L, B".to_owned()),
            0x9 => Ok("LD L, C".to_owned()),
            0xA => Ok("LD L, D".to_owned()),
            0xB => Ok("LD L, E".to_owned()),
            0xC => Ok("LD L, H".to_owned()),
            0xD => Ok("LD L, L".to_owned()),
            0xE => Ok("LD L, (HL)".to_owned()),
            0xF => Ok("LD L, A".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0x70 => match low_nibble {
            0x0 => Ok("LD (HL), B".to_owned()),
            0x1 => Ok("LD (HL), C".to_owned()),
            0x2 => Ok("LD (HL), D".to_owned()),
            0x3 => Ok("LD (HL), E".to_owned()),
            0x4 => Ok("LD (HL), H".to_owned()),
            0x5 => Ok("LD (HL), L".to_owned()),
            0x6 => Ok("HALT".to_owned()),
            0x7 => Ok("LD (HL), A".to_owned()),
            0x8 => Ok("LD A, B".to_owned()),
            0x9 => Ok("LD A, C".to_owned()),
            0xA => Ok("LD A, D".to_owned()),
            0xB => Ok("LD A, E".to_owned()),
            0xC => Ok("LD A, H".to_owned()),
            0xD => Ok("LD A, L".to_owned()),
            0xE => Ok("LD A, (HL)".to_owned()),
            0xF => Ok("LD A, A".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0x80 => match low_nibble {
            0x0 => Ok("ADD A, B".to_owned()),
            0x1 => Ok("ADD A, C".to_owned()),
            0x2 => Ok("ADD A, D".to_owned()),
            0x3 => Ok("ADD A, E".to_owned()),
            0x4 => Ok("ADD A, H".to_owned()),
            0x5 => Ok("ADD A, L".to_owned()),
            0x6 => Ok("ADD A, (HL)".to_owned()),
            0x7 => Ok("ADD A, A".to_owned()),
            0x8 => Ok("ADC A, B".to_owned()),
            0x9 => Ok("ADC A, C".to_owned()),
            0xA => Ok("ADC A, D".to_owned()),
            0xB => Ok("ADC A, E".to_owned()),
            0xC => Ok("ADC A, H".to_owned()),
            0xD => Ok("ADC A, L".to_owned()),
            0xE => Ok("ADC A, (HL)".to_owned()),
            0xF => Ok("ADC A, A".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0x90 => match low_nibble {
            0x0 => Ok("SUB A, B".to_owned()),
            0x1 => Ok("SUB A, C".to_owned()),
            0x2 => Ok("SUB A, D".to_owned()),
            0x3 => Ok("SUB A, E".to_owned()),
            0x4 => Ok("SUB A, H".to_owned()),
            0x5 => Ok("SUB A, L".to_owned()),
            0x6 => Ok("SUB A, (HL)".to_owned()),
            0x7 => Ok("SUB A, A".to_owned()),
            0x8 => Ok("SBC A, B".to_owned()),
            0x9 => Ok("SBC A, C".to_owned()),
            0xA => Ok("SBC A, D".to_owned()),
            0xB => Ok("SBC A, E".to_owned()),
            0xC => Ok("SBC A, H".to_owned()),
            0xD => Ok("SBC A, L".to_owned()),
            0xE => Ok("SBC A, (HL)".to_owned()),
            0xF => Ok("SBC A, A".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0xA0 => match low_nibble {
            0x0 => Ok("AND A, B".to_owned()),
            0x1 => Ok("AND A, C".to_owned()),
            0x2 => Ok("AND A, D".to_owned()),
            0x3 => Ok("AND A, E".to_owned()),
            0x4 => Ok("AND A, H".to_owned()),
            0x5 => Ok("AND A, L".to_owned()),
            0x6 => Ok("AND A, (HL)".to_owned()),
            0x7 => Ok("AND A, A".to_owned()),
            0x8 => Ok("XOR A, B".to_owned()),
            0x9 => Ok("XOR A, C".to_owned()),
            0xA => Ok("XOR A, D".to_owned()),
            0xB => Ok("XOR A, E".to_owned()),
            0xC => Ok("XOR A, H".to_owned()),
            0xD => Ok("XOR A, L".to_owned()),
            0xE => Ok("XOR A, (HL)".to_owned()),
            0xF => Ok("XOR A, A".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0xB0 => match low_nibble {
            0x0 => Ok("OR A, B".to_owned()),
            0x1 => Ok("OR A, C".to_owned()),
            0x2 => Ok("OR A, D".to_owned()),
            0x3 => Ok("OR A, E".to_owned()),
            0x4 => Ok("OR A, H".to_owned()),
            0x5 => Ok("OR A, L".to_owned()),
            0x6 => Ok("OR A, (HL)".to_owned()),
            0x7 => Ok("OR A, A".to_owned()),
            0x8 => Ok("CP A, B".to_owned()),
            0x9 => Ok("CP A, C".to_owned()),
            0xA => Ok("CP A, D".to_owned()),
            0xB => Ok("CP A, E".to_owned()),
            0xC => Ok("CP A, H".to_owned()),
            0xD => Ok("CP A, L".to_owned()),
            0xE => Ok("CP A, (HL)".to_owned()),
            0xF => Ok("CP A, A".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0xC0 => match low_nibble {
            0x0 => Ok("RET NZ".to_owned()),
            0x1 => Ok("POP BC".to_owned()),
            0x2 => Ok("JP NZ, u16".to_owned()),
            0x3 => Ok("JP U16".to_owned()),
            0x4 => Ok("CALL NZ, U16".to_owned()),
            0x5 => Ok("PUSH BC".to_owned()),
            0x6 => Ok("ADD A, u8".to_owned()),
            0x7 => Ok("RST 00h".to_owned()),
            0x8 => Ok("RET Z".to_owned()),
            0x9 => Ok("RET".to_owned()),
            0xA => Ok("JP Z, U16".to_owned()),
            0xB => Ok("CB".to_owned()),
            0xC => Ok("CALL Z, U16".to_owned()),
            0xD => Ok("CALL U16".to_owned()),
            0xE => Ok("ADC A, u8".to_owned()),
            0xF => Ok("RST 08h".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0xD0 => match low_nibble {
            0x0 => Ok("RET NC".to_owned()),
            0x1 => Ok("POP DE".to_owned()),
            0x2 => Ok("JP NC, U16".to_owned()),
            0x3 => Err(log_error(byte, false)),
            0x4 => Ok("CALL NC, U16".to_owned()),
            0x5 => Ok("PUSH DE".to_owned()),
            0x6 => Ok("SUB A, u8".to_owned()),
            0x7 => Ok("RST 10h".to_owned()),
            0x8 => Ok("RET C".to_owned()),
            0x9 => Ok("RETI".to_owned()),
            0xA => Ok("JP C, U16".to_owned()),
            0xB => Err(log_error(byte, false)),
            0xC => Ok("CALL C, U16".to_owned()),
            0xD => Err(log_error(byte, false)),
            0xE => Ok("SBC A, u8".to_owned()),
            0xF => Ok("RST 18h".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0xE0 => match low_nibble {
            0x0 => Ok("LD (FF00+u8), A".to_owned()),
            0x1 => Ok("POP HL".to_owned()),
            0x2 => Ok("LD (FF00+C), A".to_owned()),
            0x3 => Err(log_error(byte, false)),
            0x4 => Err(log_error(byte, false)),
            0x5 => Ok("PUSH HL".to_owned()),
            0x6 => Ok("AND A, u8".to_owned()),
            0x7 => Ok("RST 20h".to_owned()),
            0x8 => Ok("ADD SP, i8".to_owned()),
            0x9 => Ok("JP HL".to_owned()),
            0xA => Ok("LD (U16), A".to_owned()),
            0xB => Err(log_error(byte, false)),
            0xC => Err(log_error(byte, false)),
            0xD => Err(log_error(byte, false)),
            0xE => Ok("XOR A, u8".to_owned()),
            0xF => Ok("RST 28h".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        0xF0 => match low_nibble {
            0x0 => Ok("LD A, (FF00+u8)".to_owned()),
            0x1 => Ok("POP AF".to_owned()),
            0x2 => Ok("LD A, (FF00+C)".to_owned()),
            0x3 => Ok("DI".to_owned()),
            0x4 => Err(log_error(byte, false)),
            0x5 => Ok("PUSH AF".to_owned()),
            0x6 => Ok("OR A, u8".to_owned()),
            0x7 => Ok("RST 30h".to_owned()),
            0x8 => Ok("LD HL, SP+i8".to_owned()),
            0x9 => Ok("LD SP, HL".to_owned()),
            0xA => Ok("LD A, (U16)".to_owned()),
            0xB => Ok("EI".to_owned()),
            0xC => Err(log_error(byte, false)),
            0xD => Err(log_error(byte, false)),
            0xE => Ok("CP A, u8".to_owned()),
            0xF => Ok("RST 38h".to_owned()),
            _ => Err(log_error(byte, false)),
        },
        _ => Err(log_error(byte, false)),
    }
}

pub fn decode_cb_name(byte: u8) -> Result<String, String> {
    let high_nibble = byte & 0xF0;
    let low_nibble = byte & 0x0F;

    match high_nibble {
        0x00 => match low_nibble {
            0x0 => Ok("RLC B".to_owned()),
            0x1 => Ok("RLC C".to_owned()),
            0x2 => Ok("RLC D".to_owned()),
            0x3 => Ok("RLC E".to_owned()),
            0x4 => Ok("RLC H".to_owned()),
            0x5 => Ok("RLC L".to_owned()),
            0x6 => Ok("RLC (HL)".to_owned()),
            0x7 => Ok("RLC A".to_owned()),
            0x8 => Ok("RRC B".to_owned()),
            0x9 => Ok("RRC C".to_owned()),
            0xA => Ok("RRC D".to_owned()),
            0xB => Ok("RRC E".to_owned()),
            0xC => Ok("RRC H".to_owned()),
            0xD => Ok("RRC L".to_owned()),
            0xE => Ok("RRC (HL)".to_owned()),
            0xF => Ok("RRC A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0x10 => match low_nibble {
            0x0 => Ok("RL B".to_owned()),
            0x1 => Ok("RL C".to_owned()),
            0x2 => Ok("RL D".to_owned()),
            0x3 => Ok("RL E".to_owned()),
            0x4 => Ok("RL H".to_owned()),
            0x5 => Ok("RL L".to_owned()),
            0x6 => Ok("RL (HL)".to_owned()),
            0x7 => Ok("RL A".to_owned()),
            0x8 => Ok("RR B".to_owned()),
            0x9 => Ok("RR C".to_owned()),
            0xA => Ok("RR D".to_owned()),
            0xB => Ok("RR E".to_owned()),
            0xC => Ok("RR H".to_owned()),
            0xD => Ok("RR L".to_owned()),
            0xE => Ok("RR (HL)".to_owned()),
            0xF => Ok("RR A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0x20 => match low_nibble {
            0x0 => Ok("SLC B".to_owned()),
            0x1 => Ok("SLC C".to_owned()),
            0x2 => Ok("SLC D".to_owned()),
            0x3 => Ok("SLC E".to_owned()),
            0x4 => Ok("SLC H".to_owned()),
            0x5 => Ok("SLC L".to_owned()),
            0x6 => Ok("SLC (HL)".to_owned()),
            0x7 => Ok("SLC A".to_owned()),
            0x8 => Ok("SRC B".to_owned()),
            0x9 => Ok("SRC C".to_owned()),
            0xA => Ok("SRC D".to_owned()),
            0xB => Ok("SRC E".to_owned()),
            0xC => Ok("SRC H".to_owned()),
            0xD => Ok("SRC L".to_owned()),
            0xE => Ok("SRC (HL)".to_owned()),
            0xF => Ok("SRC A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0x30 => match low_nibble {
            0x0 => Ok("SWAP B".to_owned()),
            0x1 => Ok("SWAP C".to_owned()),
            0x2 => Ok("SWAP D".to_owned()),
            0x3 => Ok("SWAP E".to_owned()),
            0x4 => Ok("SWAP H".to_owned()),
            0x5 => Ok("SWAP L".to_owned()),
            0x6 => Ok("SWAP (HL)".to_owned()),
            0x7 => Ok("SWAP A".to_owned()),
            0x8 => Ok("SRL B".to_owned()),
            0x9 => Ok("SRL C".to_owned()),
            0xA => Ok("SRL D".to_owned()),
            0xB => Ok("SRL E".to_owned()),
            0xC => Ok("SRL H".to_owned()),
            0xD => Ok("SRL L".to_owned()),
            0xE => Ok("SRL (HL)".to_owned()),
            0xF => Ok("SRL A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0x40 => match low_nibble {
            0x0 => Ok("BIT 0, B".to_owned()),
            0x1 => Ok("BIT 0, C".to_owned()),
            0x2 => Ok("BIT 0, D".to_owned()),
            0x3 => Ok("BIT 0, E".to_owned()),
            0x4 => Ok("BIT 0, H".to_owned()),
            0x5 => Ok("BIT 0, L".to_owned()),
            0x6 => Ok("BIT 0, (HL)".to_owned()),
            0x7 => Ok("BIT 0, A".to_owned()),
            0x8 => Ok("BIT 1, B".to_owned()),
            0x9 => Ok("BIT 1, C".to_owned()),
            0xA => Ok("BIT 1, D".to_owned()),
            0xB => Ok("BIT 1, E".to_owned()),
            0xC => Ok("BIT 1, H".to_owned()),
            0xD => Ok("BIT 1, L".to_owned()),
            0xE => Ok("BIT 1, (HL)".to_owned()),
            0xF => Ok("BIT 1, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0x50 => match low_nibble {
            0x0 => Ok("BIT 2, B".to_owned()),
            0x1 => Ok("BIT 2, C".to_owned()),
            0x2 => Ok("BIT 2, D".to_owned()),
            0x3 => Ok("BIT 2, E".to_owned()),
            0x4 => Ok("BIT 2, H".to_owned()),
            0x5 => Ok("BIT 2, L".to_owned()),
            0x6 => Ok("BIT 2, (HL)".to_owned()),
            0x7 => Ok("BIT 2, A".to_owned()),
            0x8 => Ok("BIT 3, B".to_owned()),
            0x9 => Ok("BIT 3, C".to_owned()),
            0xA => Ok("BIT 3, D".to_owned()),
            0xB => Ok("BIT 3, E".to_owned()),
            0xC => Ok("BIT 3, H".to_owned()),
            0xD => Ok("BIT 3, L".to_owned()),
            0xE => Ok("BIT 3, (HL)".to_owned()),
            0xF => Ok("BIT 3, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0x60 => match low_nibble {
            0x0 => Ok("BIT 4, B".to_owned()),
            0x1 => Ok("BIT 4, C".to_owned()),
            0x2 => Ok("BIT 4, D".to_owned()),
            0x3 => Ok("BIT 4, E".to_owned()),
            0x4 => Ok("BIT 4, H".to_owned()),
            0x5 => Ok("BIT 4, L".to_owned()),
            0x6 => Ok("BIT 4, (HL)".to_owned()),
            0x7 => Ok("BIT 4, A".to_owned()),
            0x8 => Ok("BIT 5, B".to_owned()),
            0x9 => Ok("BIT 5, C".to_owned()),
            0xA => Ok("BIT 5, D".to_owned()),
            0xB => Ok("BIT 5, E".to_owned()),
            0xC => Ok("BIT 5, H".to_owned()),
            0xD => Ok("BIT 5, L".to_owned()),
            0xE => Ok("BIT 5, (HL)".to_owned()),
            0xF => Ok("BIT 5, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0x70 => match low_nibble {
            0x0 => Ok("BIT 6, B".to_owned()),
            0x1 => Ok("BIT 6, C".to_owned()),
            0x2 => Ok("BIT 6, D".to_owned()),
            0x3 => Ok("BIT 6, E".to_owned()),
            0x4 => Ok("BIT 6, H".to_owned()),
            0x5 => Ok("BIT 6, L".to_owned()),
            0x6 => Ok("BIT 6, (HL)".to_owned()),
            0x7 => Ok("BIT 6, A".to_owned()),
            0x8 => Ok("BIT 7, B".to_owned()),
            0x9 => Ok("BIT 7, C".to_owned()),
            0xA => Ok("BIT 7, D".to_owned()),
            0xB => Ok("BIT 7, E".to_owned()),
            0xC => Ok("BIT 7, H".to_owned()),
            0xD => Ok("BIT 7, L".to_owned()),
            0xE => Ok("BIT 7, (HL)".to_owned()),
            0xF => Ok("BIT 7, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0x80 => match low_nibble {
            0x0 => Ok("RES 0, B".to_owned()),
            0x1 => Ok("RES 0, C".to_owned()),
            0x2 => Ok("RES 0, D".to_owned()),
            0x3 => Ok("RES 0, E".to_owned()),
            0x4 => Ok("RES 0, H".to_owned()),
            0x5 => Ok("RES 0, L".to_owned()),
            0x6 => Ok("RES 0, (HL)".to_owned()),
            0x7 => Ok("RES 0, A".to_owned()),
            0x8 => Ok("RES 1, B".to_owned()),
            0x9 => Ok("RES 1, C".to_owned()),
            0xA => Ok("RES 1, D".to_owned()),
            0xB => Ok("RES 1, E".to_owned()),
            0xC => Ok("RES 1, H".to_owned()),
            0xD => Ok("RES 1, L".to_owned()),
            0xE => Ok("RES 1, (HL)".to_owned()),
            0xF => Ok("RES 1, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0x90 => match low_nibble {
            0x0 => Ok("RES 2, B".to_owned()),
            0x1 => Ok("RES 2, C".to_owned()),
            0x2 => Ok("RES 2, D".to_owned()),
            0x3 => Ok("RES 2, E".to_owned()),
            0x4 => Ok("RES 2, H".to_owned()),
            0x5 => Ok("RES 2, L".to_owned()),
            0x6 => Ok("RES 2, (HL)".to_owned()),
            0x7 => Ok("RES 2, A".to_owned()),
            0x8 => Ok("RES 3, B".to_owned()),
            0x9 => Ok("RES 3, C".to_owned()),
            0xA => Ok("RES 3, D".to_owned()),
            0xB => Ok("RES 3, E".to_owned()),
            0xC => Ok("RES 3, H".to_owned()),
            0xD => Ok("RES 3, L".to_owned()),
            0xE => Ok("RES 3, (HL)".to_owned()),
            0xF => Ok("RES 3, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0xA0 => match low_nibble {
            0x0 => Ok("RES 4, B".to_owned()),
            0x1 => Ok("RES 4, C".to_owned()),
            0x2 => Ok("RES 4, D".to_owned()),
            0x3 => Ok("RES 4, E".to_owned()),
            0x4 => Ok("RES 4, H".to_owned()),
            0x5 => Ok("RES 4, L".to_owned()),
            0x6 => Ok("RES 4, (HL)".to_owned()),
            0x7 => Ok("RES 4, A".to_owned()),
            0x8 => Ok("RES 5, B".to_owned()),
            0x9 => Ok("RES 5, C".to_owned()),
            0xA => Ok("RES 5, D".to_owned()),
            0xB => Ok("RES 5, E".to_owned()),
            0xC => Ok("RES 5, H".to_owned()),
            0xD => Ok("RES 5, L".to_owned()),
            0xE => Ok("RES 5, (HL)".to_owned()),
            0xF => Ok("RES 5, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0xB0 => match low_nibble {
            0x0 => Ok("RES 6, B".to_owned()),
            0x1 => Ok("RES 6, C".to_owned()),
            0x2 => Ok("RES 6, D".to_owned()),
            0x3 => Ok("RES 6, E".to_owned()),
            0x4 => Ok("RES 6, H".to_owned()),
            0x5 => Ok("RES 6, L".to_owned()),
            0x6 => Ok("RES 6, (HL)".to_owned()),
            0x7 => Ok("RES 6, A".to_owned()),
            0x8 => Ok("RES 7, B".to_owned()),
            0x9 => Ok("RES 7, C".to_owned()),
            0xA => Ok("RES 7, D".to_owned()),
            0xB => Ok("RES 7, E".to_owned()),
            0xC => Ok("RES 7, H".to_owned()),
            0xD => Ok("RES 7, L".to_owned()),
            0xE => Ok("RES 7, (HL)".to_owned()),
            0xF => Ok("RES 7, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0xC0 => match low_nibble {
            0x0 => Ok("SET 0, B".to_owned()),
            0x1 => Ok("SET 0, C".to_owned()),
            0x2 => Ok("SET 0, D".to_owned()),
            0x3 => Ok("SET 0, E".to_owned()),
            0x4 => Ok("SET 0, H".to_owned()),
            0x5 => Ok("SET 0, L".to_owned()),
            0x6 => Ok("SET 0, (HL)".to_owned()),
            0x7 => Ok("SET 0, A".to_owned()),
            0x8 => Ok("SET 1, B".to_owned()),
            0x9 => Ok("SET 1, C".to_owned()),
            0xA => Ok("SET 1, D".to_owned()),
            0xB => Ok("SET 1, E".to_owned()),
            0xC => Ok("SET 1, H".to_owned()),
            0xD => Ok("SET 1, L".to_owned()),
            0xE => Ok("SET 1, (HL)".to_owned()),
            0xF => Ok("SET 1, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0xD0 => match low_nibble {
            0x0 => Ok("SET 2, B".to_owned()),
            0x1 => Ok("SET 2, C".to_owned()),
            0x2 => Ok("SET 2, D".to_owned()),
            0x3 => Ok("SET 2, E".to_owned()),
            0x4 => Ok("SET 2, H".to_owned()),
            0x5 => Ok("SET 2, L".to_owned()),
            0x6 => Ok("SET 2, (HL)".to_owned()),
            0x7 => Ok("SET 2, A".to_owned()),
            0x8 => Ok("SET 3, B".to_owned()),
            0x9 => Ok("SET 3, C".to_owned()),
            0xA => Ok("SET 3, D".to_owned()),
            0xB => Ok("SET 3, E".to_owned()),
            0xC => Ok("SET 3, H".to_owned()),
            0xD => Ok("SET 3, L".to_owned()),
            0xE => Ok("SET 3, (HL)".to_owned()),
            0xF => Ok("SET 3, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0xE0 => match low_nibble {
            0x0 => Ok("SET 4, B".to_owned()),
            0x1 => Ok("SET 4, C".to_owned()),
            0x2 => Ok("SET 4, D".to_owned()),
            0x3 => Ok("SET 4, E".to_owned()),
            0x4 => Ok("SET 4, H".to_owned()),
            0x5 => Ok("SET 4, L".to_owned()),
            0x6 => Ok("SET 4, (HL)".to_owned()),
            0x7 => Ok("SET 4, A".to_owned()),
            0x8 => Ok("SET 5, B".to_owned()),
            0x9 => Ok("SET 5, C".to_owned()),
            0xA => Ok("SET 5, D".to_owned()),
            0xB => Ok("SET 5, E".to_owned()),
            0xC => Ok("SET 5, H".to_owned()),
            0xD => Ok("SET 5, L".to_owned()),
            0xE => Ok("SET 5, (HL)".to_owned()),
            0xF => Ok("SET 5, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        0xF0 => match low_nibble {
            0x0 => Ok("SET 6, B".to_owned()),
            0x1 => Ok("SET 6, C".to_owned()),
            0x2 => Ok("SET 6, D".to_owned()),
            0x3 => Ok("SET 6, E".to_owned()),
            0x4 => Ok("SET 6, H".to_owned()),
            0x5 => Ok("SET 6, L".to_owned()),
            0x6 => Ok("SET 6, (HL)".to_owned()),
            0x7 => Ok("SET 6, A".to_owned()),
            0x8 => Ok("SET 7, B".to_owned()),
            0x9 => Ok("SET 7, C".to_owned()),
            0xA => Ok("SET 7, D".to_owned()),
            0xB => Ok("SET 7, E".to_owned()),
            0xC => Ok("SET 7, H".to_owned()),
            0xD => Ok("SET 7, L".to_owned()),
            0xE => Ok("SET 7, (HL)".to_owned()),
            0xF => Ok("SET 7, A".to_owned()),
            _ => Err(log_error(byte, true)),
        },
        _ => Err(log_error(byte, true)),
    }
}

fn log_error(byte: u8, cb: bool) -> String {
    let cb = match cb {
        true => "CB",
        false => "",
    };
    format!("Instruction 0x{}{:X} not found", cb, byte)
}
